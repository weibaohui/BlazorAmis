@page "/Form/Definitions"
<Amis Data="GetObj()"></Amis>

@code {

    private object GetObj()
    {
        var data = new
        {
            definitions = new
            {
                options = new
                {
                    type = "combo",
                    multiple = true,
                    multiLine = true,
                    items = new object[]
                    {
                        new
                        {
                            type = "group",
                            body = new object[]
                            {
                                new
                                {
                                    label = "名称",
                                    name = "label",
                                    type = "input-text",
                                    required = true
                                },
                                new
                                {
                                    label = "值",
                                    name = "value",
                                    type = "input-text",
                                    required = true
                                }
                            }
                        },
                        new
                        {
                            atRef = "options",
                            label = "子选项",
                            name = "children",
                            addButtonText = "新增子选项"
                        }
                    }
                },
                queryItem = new
                {
                    type = "combo",
                    multiple = true,
                    multiLine = true,
                    typeSwitchable = false,
                    conditions = new object[]
                    {
                        new
                        {
                            label = "条件",
                            test = "!data.hasOwnProperty('connect')",
                            scaffold = new { },
                            items = new object[]
                            {
                                new
                                {
                                    type = "group",
                                    className = "m-b-none",
                                    body = new object[]
                                    {
                                        new
                                        {
                                            name = "key",
                                            type = "input-text",
                                            placeholder = "字段名",
                                            required = true
                                        },
                                        new
                                        {
                                            name = "type",
                                            type = "select",
                                            value = 0,
                                            options = new object[]
                                            {
                                                new
                                                {
                                                    label = "int64",
                                                    value = 0
                                                },
                                                new
                                                {
                                                    label = "double64",
                                                    value = 1
                                                },
                                                new
                                                {
                                                    label = "string",
                                                    value = 2
                                                },
                                                new
                                                {
                                                    label = "version",
                                                    value = 3
                                                }
                                            }
                                        },
                                        new
                                        {
                                            type = "formula",
                                            name = "opt",
                                            formula = "\"\"",
                                            condition = "${type}"
                                        },
                                        new
                                        {
                                            name = "opt",
                                            type = "select",
                                            placeholder = "请选择",
                                            required = true,
                                            options = new object[]
                                            {
                                                new
                                                {
                                                    label = ">",
                                                    value = ">",
                                                    visibleOn = "~[0,1,3].indexOf(this.type)"
                                                },
                                                new
                                                {
                                                    label = "<",
                                                    value = "<",
                                                    visibleOn = "~[0,1,3].indexOf(this.type)"
                                                },
                                                new
                                                {
                                                    label = "==",
                                                    value = "=="
                                                },
                                                new
                                                {
                                                    label = ">=",
                                                    value = ">=",
                                                    visibleOn = "~[0,1,3].indexOf(this.type)"
                                                },
                                                new
                                                {
                                                    label = "<=",
                                                    value = "<=",
                                                    visibleOn = "~[0,1,3].indexOf(this.type)"
                                                },
                                                new
                                                {
                                                    label = "in",
                                                    value = "in"
                                                },
                                                new
                                                {
                                                    label = "not in",
                                                    value = "not in"
                                                },
                                                new
                                                {
                                                    label = "!=",
                                                    value = "!="
                                                }
                                            }
                                        },
                                        new
                                        {
                                            name = "val",
                                            type = "input-text",
                                            placeholder = "值",
                                            required = true,
                                            visibleOn = "~[\">\", \"<\", \">=\", \"<=\", \"==\", \"!=\"].indexOf(this.opt)"
                                        },
                                        new
                                        {
                                            name = "val",
                                            type = "array",
                                            required = true,
                                            minLength = 1,
                                            items = new
                                            {
                                                type = "input-text",
                                                placeholder = "值",
                                                required = true
                                            },
                                            visibleOn = "~[\"in\", \"not in\"].indexOf(this.opt)"
                                        }
                                    }
                                }
                            }
                        },
                        new
                        {
                            label = "组合",
                            test = "data.hasOwnProperty('connect')",
                            scaffold = new
                            {
                                connect = "&",
                                exprs = new object[] { }
                            },
                            items = new object[]
                            {
                                new
                                {
                                    type = "button-group-select",
                                    name = "connect",
                                    value = "&",
                                    clearable = false,
                                    size = "xs",
                                    options = new object[]
                                    {
                                        new
                                        {
                                            label = "AND",
                                            value = "&"
                                        },
                                        new
                                        {
                                            label = "OR",
                                            value = "|"
                                        }
                                    }
                                },
                                new
                                {
                                    atRef = "queryItem",
                                    name = "exprs",
                                    minLength = 1,
                                    value = new object[] { }
                                }
                            }
                        }
                    }
                },
                queryGroup = new
                {
                    type = "combo",
                    multiple = false,
                    multiLine = true,
                    items = new object[]
                    {
                        new
                        {
                            type = "button-group-select",
                            name = "connect",
                            value = "&",
                            clearable = false,
                            size = "sm",
                            options = new object[]
                            {
                                new
                                {
                                    label = "AND",
                                    value = "&"
                                },
                                new
                                {
                                    label = "OR",
                                    value = "|"
                                }
                            }
                        },
                        new
                        {
                            atRef = "queryItem",
                            name = "exprs",
                            minLength = 1,
                            value = new object[] { }
                        }
                    }
                }
            },
            type = "page",
            title = "引用",
            body = new object[]
            {
                new
                {
                    type = "form",
                    api = "https://3xsw4ap8wah59.cfc-execute.bj.baidubce.com/api/amis-mock/mock/saveForm",
                    mode = "horizontal",
                    body = new object[]
                    {
                        new
                        {
                            atRef = "options",
                            name = "options",
                            value = new object[]
                            {
                                new
                                {
                                    label = "选项1",
                                    value = "1"
                                }
                            },
                            minLength = 1,
                            label = "选项配置"
                        }
                    }
                },
                new
                {
                    type = "form",
                    api = "https://3xsw4ap8wah59.cfc-execute.bj.baidubce.com/api/amis-mock/mock/saveForm",
                    body = new object[]
                    {
                        new
                        {
                            atRef = "queryGroup",
                            name = "q",
                            value = new { },
                            label = "Query"
                        },
                        new
                        {
                            type = "static",
                            name = "q",
                            label = "当前值",
                            tpl = "<pre>${q|json}</pre>"
                        }
                    }
                }
            }
        };
        return data;
    }

}
